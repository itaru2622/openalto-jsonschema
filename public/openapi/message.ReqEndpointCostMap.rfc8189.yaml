allOf:
  - type: object
    properties:
      cost-type:
        type: object
        properties:
          cost-mode:
            type: string
            enum:
              - numerical
              - ordinal
          cost-metric:
            anyOf:
              - type: string
                pattern: ^[0-9a-zA-Z-:_.]{1,32}$
              - enum:
                  - routingcost
                  - delay-ow
                  - delay-rt
                  - delay-variation
                  - hopcount
                  - lossrate
                  - tput
                  - bw-residual
                  - bw-maxres
        required:
          - cost-mode
          - cost-metric
      multi-cost-types:
        type: array
        items:
          type: object
          properties:
            cost-mode:
              type: string
              enum:
                - numerical
                - ordinal
            cost-metric:
              anyOf:
                - type: string
                  pattern: ^[0-9a-zA-Z-:_.]{1,32}$
                - enum:
                    - routingcost
                    - delay-ow
                    - delay-rt
                    - delay-variation
                    - hopcount
                    - lossrate
                    - tput
                    - bw-residual
                    - bw-maxres
          required:
            - cost-mode
            - cost-metric
        minItems: 1
      constraints:
        type: array
        items:
          type: string
      testable-cost-types:
        type: array
        items:
          type: object
          properties:
            cost-mode:
              type: string
              enum:
                - numerical
                - ordinal
            cost-metric:
              anyOf:
                - type: string
                  pattern: ^[0-9a-zA-Z-:_.]{1,32}$
                - enum:
                    - routingcost
                    - delay-ow
                    - delay-rt
                    - delay-variation
                    - hopcount
                    - lossrate
                    - tput
                    - bw-residual
                    - bw-maxres
          required:
            - cost-mode
            - cost-metric
        minItems: 1
      or-constraints:
        type: array
        items:
          type: array
          items:
            type: string
          minItems: 1
        minItems: 1
      endpoints:
        type: object
        properties:
          srcs:
            type: array
            items:
              type: string
              oneOf:
                - pattern: ipv4:(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\.|$)){4}
                - pattern: ipv6:((((:|[0-9a-fA-F]{0,4}):)([0-9a-fA-F]{0,4}:){0,5}((([0-9a-fA-F]{0,4}:)?(:|[0-9a-fA-F]{0,4}))|(((25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])))(%[a-zA-Z0-9]+)?)|((([^:]+:){6}(([^:]+:[^:]+)|(.*\..*)))|((([^:]+:)*[^:]+)?::(([^:]+:)*[^:]+)?)(%.+)?;))
          dsts:
            type: array
            items:
              type: string
              oneOf:
                - pattern: ipv4:(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\.|$)){4}
                - pattern: ipv6:((((:|[0-9a-fA-F]{0,4}):)([0-9a-fA-F]{0,4}:){0,5}((([0-9a-fA-F]{0,4}:)?(:|[0-9a-fA-F]{0,4}))|(((25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])))(%[a-zA-Z0-9]+)?)|((([^:]+:){6}(([^:]+:[^:]+)|(.*\..*)))|((([^:]+:)*[^:]+)?::(([^:]+:)*[^:]+)?)(%.+)?;))
        additionalProperties: true
    additionalProperties: true
    oneOf:
      - required:
          - cost-type
          - endpoints
      - required:
          - multi-cost-types
          - endpoints
